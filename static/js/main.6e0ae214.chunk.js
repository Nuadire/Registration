(this.webpackJsonpregistration=this.webpackJsonpregistration||[]).push([[0],{135:function(e,t,n){e.exports=n(257)},146:function(e,t,n){},243:function(e,t,n){},244:function(e,t,n){},257:function(e,t,n){"use strict";n.r(t);n(136);var a,r,o,c=n(0),i=n.n(c),s=n(29),l=n(33),u=n(112),m=Object(u.a)(),g=n(46),p=n(113),b=n(114),f=n(22),E=n(259),O=n(263),d=Object(O.a)("USERS_REGISTER_REQUEST"),h=Object(O.a)("USERS_REGISTER_SUCCESS"),j=Object(O.a)("USERS_REGISTER_FAILURE"),v=Object(O.a)("USERS_LOGIN_REQUEST"),S=Object(O.a)("USERS_LOGIN_SUCCESS"),y=Object(O.a)("USERS_LOGIN_FAILURE"),w=Object(O.a)("USERS_LOGOUT"),I=Object(O.a)("ALERT_SUCCESS"),R=Object(O.a)("ALERT_ERROR"),C=Object(O.a)("ALERT_CLEAR"),T=JSON.parse(localStorage.getItem("user")),U=T?{loggedIn:!0,user:T}:{},_=Object(E.a)((a={},Object(f.a)(a,v,(function(e,t){return{loggingIn:!0,user:t.payload}})),Object(f.a)(a,S,(function(e,t){return{loggingIn:!0,user:t.payload}})),Object(f.a)(a,y,(function(){return{loggingIn:!1}})),Object(f.a)(a,w,(function(){return{loggingIn:!1}})),a),U),L=Object(E.a)((r={},Object(f.a)(r,d,(function(){return{registering:!0}})),Object(f.a)(r,h,(function(){return{}})),Object(f.a)(r,j,(function(){return{}})),r),{}),N=Object(E.a)((o={},Object(f.a)(o,I,(function(e,t){return{type:"success",message:t.payload}})),Object(f.a)(o,R,(function(e,t){var n=t.payload;return{type:"error",message:Object.keys(n).reduce((function(e,t){var a=n[t].join(", ");return"".concat(e," ").concat(t," ").concat(a,"\n")}),"").trim()}})),Object(f.a)(o,C,(function(){return{}})),o),{}),k=Object(g.c)({authentication:_,registration:L,alert:N}),P=Object(b.createLogger)(),x=Object(g.d)(k,Object(g.a)(p.a,P)),A=n(66),F=n(67),G=n(78),J=n(77),q=n(37),B=n(8),Q=n(262),W=n(134),H=function(e){var t=e.component,n=Object(W.a)(e,["component"]);return i.a.createElement(B.b,Object.assign({},n,{render:function(e){return localStorage.getItem("user")?i.a.createElement(t,e):i.a.createElement(B.a,{to:{pathname:"/login",state:{from:e.location}}})}}))};var $=Object(l.b)((function(e){return e.authentication.user}))((function(e){var t=e.user;return i.a.createElement(i.a.Fragment,null,i.a.createElement("h1",null,"Hi ",t.username,"!"),i.a.createElement("p",null,i.a.createElement(q.b,{to:"/login"},"Logout")))})),z=n(258),D=n(261),K=n(91),M=n(58),V=n.n(M),X=n(88);function Y(){localStorage.removeItem("user")}var Z=function(e){return e.text().then((function(t){var n=t&&JSON.parse(t);if(!e.ok){401===e.status&&(Y(),window.location.reload(!0));var a=n&&n.errors||e.statusText;return Promise.reject(a)}return n}))};var ee={login:function(e,t){var n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:{email:e.toLowerCase(),password:t}})};return fetch("".concat("https://conduit.productionready.io/api/","users/login"),n).then(Z).then((function(e){return localStorage.setItem("user",JSON.stringify(e)),e}))},logout:Y,register:function(e){var t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),redirect:"follow"};return fetch("".concat("https://conduit.productionready.io/api/","users"),t).then(Z)}},te={login:function(e,t,n){return function(){var a=Object(X.a)(V.a.mark((function a(r){var o;return V.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r(v()),a.prev=1,a.next=4,ee.login(e,t);case 4:o=a.sent,r(S(o)),n.push("/"),a.next=13;break;case 9:a.prev=9,a.t0=a.catch(1),r(y(a.t0)),r(R(a.t0));case 13:case"end":return a.stop()}}),a,null,[[1,9]])})));return function(e){return a.apply(this,arguments)}}()},logout:function(){return function(e){ee.logout(),e(w())}},register:function(e,t){return function(){var n=Object(X.a)(V.a.mark((function n(a){return V.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a(d(e)),n.prev=1,n.next=4,ee.register(e);case 4:a(h(e)),t.push("/login"),a(I("Registration successful")),n.next=13;break;case 9:n.prev=9,n.t0=n.catch(1),a(j(n.t0)),a(R(n.t0));case 13:case"end":return n.stop()}}),n,null,[[1,9]])})));return function(e){return n.apply(this,arguments)}}()}},ne=(n(146),{labelCol:{span:8},wrapperCol:{span:8}}),ae={wrapperCol:{offset:8,span:8}},re=function(e){Object(G.a)(n,e);var t=Object(J.a)(n);function n(e){var a;return Object(A.a)(this,n),(a=t.call(this,e)).onFinish=function(e){var t=e.email,n=e.password,r=a.props;(0,r.login)(t,n,r.history)},(0,a.props.logout)(),a}return Object(F.a)(n,[{key:"render",value:function(){var e=this.props.loggingIn;return i.a.createElement(z.a,Object.assign({},ne,{name:"basic",onFinish:this.onFinish,className:"login-form"}),i.a.createElement(z.a.Item,{name:"email",label:"Email",rules:[{type:"email",required:!0}]},i.a.createElement(D.a,null)),i.a.createElement(z.a.Item,{name:"password",label:"Password",rules:[{required:!0,message:"Please input your password!"}]},i.a.createElement(D.a.Password,null)),i.a.createElement(z.a.Item,ae,i.a.createElement(K.a,{type:"primary",htmlType:"submit",loading:e},"Login"),i.a.createElement(q.b,{className:"login-form--signup",to:"/signup"},"Registration")))}}]),n}(i.a.PureComponent);re.defaultProps={loggingIn:!1};var oe={login:te.login,logout:te.logout},ce=Object(l.b)((function(e){return{loggingIn:e.authentication.loggingIn}}),oe)(re),ie=(n(243),{labelCol:{span:8},wrapperCol:{span:8}}),se={wrapperCol:{offset:8,span:8}},le=function(e){var t=e.register,n=e.registering,a=e.history;return i.a.createElement(z.a,Object.assign({},ie,{name:"basic",onFinish:function(e){t({user:e,history:a})},className:"registration-form"}),i.a.createElement(z.a.Item,{name:"username",label:"Username",rules:[{required:!0}]},i.a.createElement(D.a,null)),i.a.createElement(z.a.Item,{name:"email",label:"Email",rules:[{type:"email",required:!0}]},i.a.createElement(D.a,null)),i.a.createElement(z.a.Item,{name:"password",label:"Password",rules:[{required:!0,message:"Please input your password!"}]},i.a.createElement(D.a.Password,null)),i.a.createElement(z.a.Item,se,i.a.createElement(K.a,{type:"primary",htmlType:"submit",loading:n},"Register"),i.a.createElement(q.b,{to:"/login",className:"registration-form--signup"},"Cancel")))};le.defaultProps={registering:!1};var ue={register:te.register},me=Object(l.b)((function(e){return{registering:e.registration.registering}}),ue)(le),ge=(n(244),function(e){Object(G.a)(n,e);var t=Object(J.a)(n);function n(e){var a;return Object(A.a)(this,n),a=t.call(this,e),m.listen((function(){(0,a.props.clearAlerts)()})),a}return Object(F.a)(n,[{key:"render",value:function(){var e=this.props.alert;return i.a.createElement("div",{className:"app"},e.message&&i.a.createElement(Q.a,{type:e.type,message:e.message}),i.a.createElement(q.a,null,i.a.createElement(B.d,null,i.a.createElement(H,{exact:!0,path:"/",component:$}),i.a.createElement(B.b,{path:"/login",component:ce}),i.a.createElement(B.b,{path:"/signup",component:me}))))}}]),n}(i.a.Component));var pe={clearAlerts:C},be=Object(l.b)((function(e){return{alert:e.alert}}),pe)(ge);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));Object(s.render)(i.a.createElement(l.a,{store:x},i.a.createElement(be,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[135,1,2]]]);
//# sourceMappingURL=main.6e0ae214.chunk.js.map