(this.webpackJsonpregistration=this.webpackJsonpregistration||[]).push([[0],{135:function(e,t,n){e.exports=n(256)},146:function(e,t,n){},243:function(e,t,n){},256:function(e,t,n){"use strict";n.r(t);n(136);var a,r,o,c=n(0),i=n.n(c),s=n(29),l=n(33),u=n(108),g=Object(u.a)(),m=n(46),p=n(109),f=n(110),b=n(22),E=n(258),O=n(262),d=Object(O.a)("USERS_REGISTER_REQUEST"),j=Object(O.a)("USERS_REGISTER_SUCCESS"),h=Object(O.a)("USERS_REGISTER_FAILURE"),S=Object(O.a)("USERS_LOGIN_REQUEST"),v=Object(O.a)("USERS_LOGIN_SUCCESS"),R=Object(O.a)("USERS_LOGIN_FAILURE"),y=Object(O.a)("USERS_LOGOUT"),w=Object(O.a)("ALERT_SUCCESS"),I=Object(O.a)("ALERT_ERROR"),C=Object(O.a)("ALERT_CLEAR"),T=JSON.parse(localStorage.getItem("user")),U=T?{loggedIn:!0,user:T}:{},_=Object(E.a)((a={},Object(b.a)(a,S,(function(e,t){return{loggingIn:!0,user:t.payload}})),Object(b.a)(a,v,(function(e,t){return{loggingIn:!0,user:t.payload}})),Object(b.a)(a,R,(function(){return{}})),Object(b.a)(a,y,(function(){return{}})),a),U),L=Object(E.a)((r={},Object(b.a)(r,d,(function(){return{registering:!0}})),Object(b.a)(r,j,(function(){return{}})),Object(b.a)(r,h,(function(){return{}})),r),{}),N=Object(E.a)((o={},Object(b.a)(o,w,(function(e,t){return{type:"success",message:t.payload}})),Object(b.a)(o,I,(function(e,t){var n=t.payload;return{type:"error",message:Object.keys(n).reduce((function(e,t){var a=n[t].join(", ");return"".concat(e," ").concat(t," ").concat(a,"\n")}),"").trim()}})),Object(b.a)(o,C,(function(){return{}})),o),{}),k=Object(m.c)({authentication:_,registration:L,alert:N}),x=Object(f.createLogger)(),P=Object(m.d)(k,Object(m.a)(p.a,x)),A=n(111),G=n(112),J=n(133),q=n(130),F=n(8),B=n(261),Q=n(134),W=function(e){var t=e.component,n=Object(Q.a)(e,["component"]);return i.a.createElement(F.b,Object.assign({},n,{render:function(e){return localStorage.getItem("user")?i.a.createElement(t,e):i.a.createElement(F.a,{to:{pathname:"/Registration/login",state:{from:e.location}}})}}))},H=n(39),$=n(58),z=n.n($),D=n(84);function K(){localStorage.removeItem("user")}var M=function(e){return e.text().then((function(t){var n=t&&JSON.parse(t);if(!e.ok){401===e.status&&(K(),window.location.reload(!0));var a=n&&n.errors||e.statusText;return Promise.reject(a)}return n}))};var V={login:function(e,t){var n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:{email:e.toLowerCase(),password:t}})};return fetch("".concat("https://conduit.productionready.io/api/","users/login"),n).then(M).then((function(e){return localStorage.setItem("user",JSON.stringify(e)),e}))},logout:K,register:function(e){var t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),redirect:"follow"};return fetch("".concat("https://conduit.productionready.io/api/","users"),t).then(M)}},X={login:function(e,t){return function(){var n=Object(D.a)(z.a.mark((function n(a){var r;return z.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a(S()),n.prev=1,n.next=4,V.login(e,t);case 4:r=n.sent,a(v(r)),g.push("/Registration"),n.next=13;break;case 9:n.prev=9,n.t0=n.catch(1),a(R(n.t0)),a(I(n.t0));case 13:case"end":return n.stop()}}),n,null,[[1,9]])})));return function(e){return n.apply(this,arguments)}}()},logout:function(){return V.logout(),y()},register:function(e){return function(){var t=Object(D.a)(z.a.mark((function t(n){return z.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(d(e)),t.prev=1,t.next=4,V.register(e);case 4:n(j(e)),g.push("/Registration/login"),n(w("Registration successful")),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),n(h(t.t0)),n(I(t.t0));case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}()}};var Y=Object(l.b)((function(e){return e.authentication.user}),(function(){return{logout:X.logout}}))((function(e){var t=e.user,n=e.logout;return i.a.createElement(i.a.Fragment,null,i.a.createElement("h1",null,"Hi ",t.username,"!"),i.a.createElement("p",null,i.a.createElement(H.a,{to:"/Registration/login",onClick:n},"Logout")))})),Z=n(257),ee=n(260),te=n(87),ne=(n(146),{labelCol:{span:8},wrapperCol:{span:8}}),ae={wrapperCol:{offset:8,span:8}},re=function(e){var t=e.login,n=e.loggingIn;return i.a.createElement(Z.a,Object.assign({},ne,{name:"basic",onFinish:function(e){var n=e.email,a=e.password;t(n,a)},className:"login-form"}),i.a.createElement(Z.a.Item,{name:"email",label:"Email",rules:[{type:"email",required:!0}]},i.a.createElement(ee.a,null)),i.a.createElement(Z.a.Item,{name:"password",label:"Password",rules:[{required:!0,message:"Please input your password!"}]},i.a.createElement(ee.a.Password,null)),i.a.createElement(Z.a.Item,ae,i.a.createElement(te.a,{type:"primary",htmlType:"submit",loading:n},"Login"),i.a.createElement(H.a,{className:"login-form--signup",to:"/Registration/signup"},"Registration")))};re.defaultProps={loggingIn:!1};var oe={login:X.login},ce=Object(l.b)((function(e){return{loggingIn:e.authentication.loggingIn}}),oe)(re),ie=(n(243),{labelCol:{span:8},wrapperCol:{span:8}}),se={wrapperCol:{offset:8,span:8}},le=function(e){var t=e.register,n=e.registering;return i.a.createElement(Z.a,Object.assign({},ie,{name:"basic",onFinish:function(e){t({user:e})},className:"registration-form"}),i.a.createElement(Z.a.Item,{name:"username",label:"Username",rules:[{required:!0}]},i.a.createElement(ee.a,null)),i.a.createElement(Z.a.Item,{name:"email",label:"Email",rules:[{type:"email",required:!0}]},i.a.createElement(ee.a,null)),i.a.createElement(Z.a.Item,{name:"password",label:"Password",rules:[{required:!0,message:"Please input your password!"}]},i.a.createElement(ee.a.Password,null)),i.a.createElement(Z.a.Item,se,i.a.createElement(te.a,{type:"primary",htmlType:"submit",loading:n},"Register"),i.a.createElement(H.a,{to:"/Registration/login",className:"registration-form--signup"},"Cancel")))};le.defaultProps={registering:!1};var ue={register:X.register},ge=Object(l.b)((function(e){return{registering:e.registration.registering}}),ue)(le),me=function(e){Object(J.a)(n,e);var t=Object(q.a)(n);function n(e){var a;return Object(A.a)(this,n),a=t.call(this,e),g.listen((function(){a.props.clearAlerts()})),a}return Object(G.a)(n,[{key:"render",value:function(){var e=this.props.alert;return i.a.createElement("div",{className:"app"},e.message&&i.a.createElement(B.a,{type:e.type,message:e.message}),i.a.createElement(F.c,{history:g},i.a.createElement(F.d,null,i.a.createElement(W,{exact:!0,path:"/Registration",component:Y}),i.a.createElement(F.b,{exact:!0,path:"/Registration/login",component:ce}),i.a.createElement(F.b,{exact:!0,path:"/Registration/signup",component:ge}))))}}]),n}(i.a.Component);var pe={clearAlerts:C},fe=Object(l.b)((function(e){return{alert:e.alert}}),pe)(me);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));Object(s.render)(i.a.createElement(l.a,{store:P},i.a.createElement(fe,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[135,1,2]]]);
//# sourceMappingURL=main.3f8cf712.chunk.js.map